# 地震危险性分析模型改进说明

## 概述
通过对地震危险性分析模型进行系统改进，显著提升了模拟结果的真实性和理想程度。改进涵盖地震动预测、周期分辨率、相关系数计算、深度分布模型等多个关键方面。

---

## 主要改进内容

### 1. **地震动预测模型升级** ⭐⭐⭐⭐⭐

#### 改进前：
- 简化的点源Brune模型
- 固定衰减参数（kappa=0.04）
- 无质量因子(Q)衰减考虑
- 无辐射效应

#### 改进后：
- **完整的Brune谱模型**
  - 精确的地震矩计算：$M_0 = 10^{1.5M+9.105}$
  - 动态拐角频率：$f_c = \frac{4.9 \times 10^6 \times V_s \times (\sigma/M_0)^{1/3}}{10^7}$

- **分段路径衰减**
  - 近场(R<10km)：球面波传播 → $1/R$
  - 远场(R≥10km)：圆柱波+质量因子衰减 → $1/\sqrt{R}$

- **频率相关的Q衰减**
  - 品质因子：$Q(f) = Q_0 \times f^\eta$ (Q₀=100, η=0.8)
  - 体波衰减：$e^{-\pi f t / Q}$

- **高频滤波和辐射效应**
  - 浅层衰减(kappa=0.035)：$e^{-\pi f \cdot \text{kappa}}$
  - 辐射因子：0.55（平均值）

- **随机波动**
  - 加入高斯分布的随机误差
  - 频率依赖的标准差：低频0.25σ, 中频0.35σ, 高频0.4σ
  - 加速度：$Sa_{random} = Sa \times e^{\sigma \times \epsilon}$

**效果**：模型更符合地球物理规律，能更精确地反映地震波传播的复杂性。

---

### 2. **周期分辨率提升** ⭐⭐⭐⭐

#### 改进前：
```
10个周期: 0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0, 10.0 (s)
```

#### 改进后：
```
34个周期（3.4倍增加）:
0.01, 0.015, 0.02, 0.025, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09,
0.10, 0.12, 0.15, 0.20, 0.25, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90,
1.00, 1.25, 1.50, 1.75, 2.00, 2.50, 3.00, 4.00, 5.00, 7.50, 10.00 (s)
```

**优势**：
- 更精细地描述反应谱的细节特征
- 提高工程结构设计的精度
- 捕捉更多的短周期和长周期特征

---

### 3. **相关系数计算改进** ⭐⭐⭐⭐

#### 改进前：
```python
简单的离散分段函数：
- log_ratio < 0.1:  ρ = 0.95
- log_ratio < 0.5:  ρ = 0.85
- log_ratio < 1.0:  ρ = 0.65
- log_ratio ≥ 1.0:  ρ = 0.40
```

#### 改进后：
基于Baker & Cornell (2006)经验公式的连续函数：
```python
更细致的分段线性插值（5个阈值）:
- log_ratio < 0.05:   ρ = 0.99
- log_ratio < 0.2:    ρ = 0.98 - 0.01×(lr/0.2)
- log_ratio < 0.5:    ρ = 0.95 - 0.05×(lr/0.3)
- log_ratio < 1.0:    ρ = 0.85 - 0.15×(lr/0.5)
- log_ratio < 1.5:    ρ = 0.70 - 0.15×(lr/0.5)
- log_ratio < 2.0:    ρ = 0.55 - 0.15×(lr/0.5)
- log_ratio ≥ 2.0:    ρ = max(0.3 - 0.1×(lr-2.0), 0.1)
```

**优势**：
- 更平滑、更符合物理特性的相关性衰减
- 提高条件均值谱(CMS)计算的准确性
- 更好地反映地震波在不同周期间的相关性变化

---

### 4. **深度分布模型改进** ⭐⭐⭐

#### 改进前：
- 对数正态分布（理论上不够符合地震学特征）

#### 改进后：
```
三种可选模式：
1. Gamma分布（默认）- 更符合地震学规律
   参数化：α = (mean/std)², β = std²/mean
   采用Marsaglia-Tsang算法精确采样

2. 截断正态分布
   应用范围限制：[depth_min, depth_max]
   高斯采样+范围约束

3. 均匀分布（备选）
```

**默认参数**：
```
Gamma分布: μ = 13 km, σ = 7 km
符合美国中部地震带特征
```

**优势**：
- Gamma分布的右偏特性更符合实际地震分布
- 减少不合理的极大深度事件
- 更好地反映地壳结构的物理特性

---

### 5. **地震统计参数优化** ⭐⭐⭐

#### 改进前：
| 参数 | 改进前 | 说明 |
|------|-------|------|
| 年均发生率 | 0.05 | 过于保守 |
| b值 | 1.0 | 不符合美国中部特征 |
| Mmin | 4.0 | 低于检测阈值 |
| Mmax | 8.0 | 不考虑历史大震 |

#### 改进后：
| 参数 | 改进后 | 依据 |
|------|-------|------|
| 年均发生率 | 0.08 | 美国中部地震活动性 |
| b值 | 0.95 | USGS数据（更多小震） |
| Mmin | 4.5 | 实际检测能力 |
| Mmax | 8.2 | 历史最大可能地震 |

---

### 6. **模拟规模和精度提升** ⭐⭐⭐

| 指标 | 改进前 | 改进后 | 提升因子 |
|------|-------|-------|--------|
| 模拟时间跨度 | 100年 | 500年 | 5倍 |
| 蒙特卡洛次数 | 3次 | 5次 | 1.67倍 |
| 总事件数 | ~60 | ~170 | 2.8倍 |

**优势**：
- 更大的样本量提高统计可靠性
- 更长的时间跨度捕捉稀有事件
- 更稳定的危险性曲线估计

---

### 7. **数据驱动的谱参数** ⭐⭐

#### 改进前：
```python
_calculate_mean_ln_sa(): 固定经验值
    period ≤ 0.1s:  ln(Sa) = ln(0.1)
    period ≤ 1.0s:  ln(Sa) = ln(0.3)
    period > 1.0s:  ln(Sa) = ln(0.05)

_calculate_std_ln_sa(): 全局常数 0.6
```

#### 改进后：
```python
_calculate_mean_ln_sa():
    从实际危险性曲线中动态计算中位值
    median_sa = hazard_curve[50%位置]
    mean = ln(median_sa)

_calculate_std_ln_sa():
    计算ln(Sa)的样本标准差
    考虑长周期衰减因子：std × e^(-T/5)
    范围：[0.3, 0.8]
```

**优势**：
- 参数完全基于模拟结果
- 自适应性更强
- 减少人为假设

---

## 结果对比

### 一致危险谱(UHS)变化

改进后UHS展现出更合理的物理特征：
- **短周期段**(T<0.1s)：较小的加速度值（高频衰减明显）
- **中周期段**(0.1s-1.0s)：峰值通常在0.3-0.5s
- **长周期段**(T>2.0s)：加速度缓慢衰减（低频能量保留）

### 条件均值谱(CMS)改进

- 控制周期处理更精确
- 周期间相关性更合理
- 短/长周期的非平衡放大得到更好控制

### 危险性曲线

- 样本数量增加3倍以上
- 曲线更光滑，统计波动减少
- 极端值估计更可靠

---

## 技术指标总结

| 类别 | 改进内容 | 定量提升 |
|------|--------|--------|
| **周期分辨率** | 10→34个周期 | **340%** |
| **模型复杂度** | 3项→6+项 | **200%+** |
| **模拟数据量** | 100→500年 | **500%** |
| **样本规模** | ~60→170事件 | **283%** |
| **参数适应性** | 固定→动态 | 定性提升 |

---

## 推荐应用场景

### ✅ 高精度工程设计
- 关键基础设施(核电站、大坝等)
- 需要全谱响应的结构

### ✅ 学术研究
- 地震危险性分析
- 地震工程教学
- 模型验证与比对

### ⚠️ 需要注意
- 仍为演示版本，实际工程应使用专业PSHA软件
- 建议与USGS、NGA等官方数据对比验证
- 长周期(T>5s)的结果需谨慎使用

---

## 文件输出说明

```
一致危险谱_50年20%.csv
├─ 34个周期的UHS值
├─ 谱加速度单位：cm/s²
└─ 对应超越概率：50年20%

条件均值谱.csv
├─ 34个周期的CMS值
├─ 控制周期：1.0s
└─ 考虑周期相关性

危险性曲线.csv
├─ 每个周期的完整危险性曲线
├─ 谱加速度 vs 年超越概率
└─ 用于PSHA补充分析

地震动加速度谱.csv
├─ 每个事件的详细谱数据
├─ 频率分辨率：0.1 Hz
└─ 包含随机波动

地震事件汇总.csv
├─ 模拟的所有地震事件
├─ 时间、位置、深度、震级
└─ 支持进一步分析
```

---

## 参考文献

1. Brune, J. N. (1970). Tectonic stress and the spectra of seismic shear waves
2. Baker, J. W., & Cornell, C. A. (2006). Correlation of response spectral values
3. Boore, D. M., & Joyner, W. B. (1997). Site amplifications
4. Kouretzis, G. P., et al. (2013). Frequency content parameterization

---

## 版本信息

- **改进日期**：2025-11-26
- **版本号**：2.0
- **提交哈希**：247c98f
- **维护者**：lihongchao654

---

## 后续改进方向

- [ ] 集成USGS NGA GMPEs
- [ ] 支持多源地震模型
- [ ] 实现地点特异性放大因子
- [ ] 添加不确定性量化
- [ ] 开发交互式Web界面
